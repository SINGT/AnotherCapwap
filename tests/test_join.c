#include "../ac_join.c"

int main(int argc, char const *argv[])
{
	struct capwap_wtp wtp = {0};
	struct cw_ctrlmsg *join;
	int err;
	uint8_t msg[] = {
	    0x0,  0x10, 0x2,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x0,  0x3,  0x3,  0x0,
	    0xa4, 0x0,  0x0,  0x1c, 0x0,  0xe,  0x4e, 0x65, 0x78, 0x74, 0x20, 0x74, 0x6f, 0x20,
	    0x46, 0x72, 0x69, 0x64, 0x67, 0x65, 0x0,  0x26, 0x0,  0x14, 0x0,  0x0,  0x5b, 0xa0,
	    0x0,  0x0,  0x0,  0x4,  0x0,  0xe2, 0x1,  0x0,  0x0,  0x1,  0x0,  0x4,  0x0,  0xe2,
	    0x1,  0x0,  0x0,  0x27, 0x0,  0x2a, 0x2,  0x2,  0x1,  0x1,  0x0,  0x0,  0x0,  0x0,
	    0x5b, 0xa0, 0x0,  0x0,  0x0,  0x4,  0x0,  0xe2, 0x1,  0x0,  0x0,  0x0,  0x5b, 0xa0,
	    0x0,  0x1,  0x0,  0x4,  0x0,  0x30, 0x0,  0x0,  0x0,  0x0,  0x5b, 0xa0, 0x0,  0x2,
	    0x0,  0x4,  0xff, 0xd6, 0x12, 0x0,  0x0,  0x1e, 0x0,  0x4,  0xc0, 0xa8, 0x4,  0x1,
	    0x0,  0x2d, 0x0,  0x8,  0x4d, 0x79, 0x20, 0x57, 0x54, 0x50, 0x20, 0x31, 0x0,  0x23,
	    0x0,  0x10, 0xc0, 0xf9, 0x3e, 0x22, 0x8,  0xe1, 0xaf, 0x59, 0xd8, 0x5d, 0xb5, 0xc8,
	    0xe5, 0xfb, 0x7f, 0x4d, 0x0,  0x29, 0x0,  0x1,  0x2,  0x0,  0x2c, 0x0,  0x1,  0x0,
	    0x0,  0x35, 0x0,  0x1,  0x0,  0x4,  0x18, 0x0,  0x5,  0x0,  0x0,  0x0,  0x0,  0x5,
	    0x4,  0x18, 0x0,  0x5,  0x1,  0x0,  0x0,  0x0,  0x2};

	join = cwmsg_ctrlmsg_malloc();
	if ((err = cwmsg_ctrlmsg_parse(join, msg, sizeof(msg)))) {
		cwmsg_ctrlmsg_free(join);
		printf("ctrl message(join) parse fail\n");
		return -1;
	}
	if ((err = capwap_parse_join_request(&wtp, join))) {
		printf("join message parse fail\n");
		return -1;
	}

	return 0;
}
